# é«˜æ ¡æ™ºèƒ½æ’è¯¾é€‰è¯¾ç®¡ç†ç³»ç»Ÿ - å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚

- Python 3.9+
- åä¸ºäº‘ TaurusDB å®ä¾‹
- Git

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿï¼‰

### 1. å…‹éš†é¡¹ç›®

```bash
cd backend
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```powershell
# Windows PowerShell
python -m venv venv
.\venv\Scripts\activate
pip install -r requirements.txt
```

### 3. é…ç½®æ•°æ®åº“è¿æ¥

å¤åˆ¶ `.env.example` ä¸º `.env`ï¼š

```powershell
Copy-Item .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ TaurusDB è¿æ¥ä¿¡æ¯ï¼š

```env
DB_HOST=your-taurusdb-endpoint.com
DB_PORT=3306
DB_USER=your_username
DB_PASSWORD=your_password
DB_NAME=course_selection_system

# ç”Ÿäº§ç¯å¢ƒå»ºè®®å¯ç”¨
DB_USE_SSL=False

# JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ï¼‰
SECRET_KEY=your-very-secret-key-min-32-characters-long
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

ç¡®ä¿å·²åœ¨ TaurusDB ä¸­æ‰§è¡Œæ•°æ®åº“è„šæœ¬ï¼š

```sql
-- è¿æ¥åˆ° TaurusDB åæ‰§è¡Œ
SOURCE ../database/01_create_table.sql
SOURCE ../database/02_triggers.sql
SOURCE ../database/03_procedures.sql
SOURCE ../database/04_insert_data.sql
```

### 5. å¯åŠ¨æœåŠ¡

```powershell
# å¼€å‘æ¨¡å¼ï¼ˆæ”¯æŒçƒ­é‡è½½ï¼‰
python -m uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### 6. è®¿é—® API æ–‡æ¡£

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š

- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## ğŸ§ª æµ‹è¯• API

### ä½¿ç”¨ Swagger UIï¼ˆæ¨èï¼‰

1. è®¿é—® http://localhost:8000/docs
2. ç‚¹å‡» `/api/auth/login` - Try it out
3. è¾“å…¥æµ‹è¯•è´¦å·ï¼š
   ```json
   {
     "username": "2021001",
     "password": "123456"
   }
   ```
4. ç‚¹å‡» Executeï¼Œå¤åˆ¶è¿”å›çš„ `access_token`
5. ç‚¹å‡»é¡µé¢å³ä¸Šè§’ "Authorize" æŒ‰é’®
6. è¾“å…¥ï¼š`Bearer <your_access_token>`
7. ç°åœ¨å¯ä»¥æµ‹è¯•å…¶ä»–éœ€è¦è®¤è¯çš„æ¥å£äº†

### ä½¿ç”¨ curl

```bash
# ç™»å½•
curl -X POST "http://localhost:8000/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username":"2021001","password":"123456"}'

# æŸ¥è¯¢å¯é€‰è¯¾ç¨‹ï¼ˆå­¦ç”ŸID=16ï¼‰
curl -X GET "http://localhost:8000/api/students/16/available-courses" \
  -H "Authorization: Bearer <your_token>"

# é€‰è¯¾
curl -X POST "http://localhost:8000/api/students/16/enroll" \
  -H "Authorization: Bearer <your_token>" \
  -H "Content-Type: application/json" \
  -d '{"instance_id":1}'
```

## ğŸ“Š æµ‹è¯•æ•°æ®

ç³»ç»Ÿå·²å†…ç½®æµ‹è¯•æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è´¦å·ç™»å½•ï¼š

| è§’è‰² | ç”¨æˆ·å | å¯†ç  | è¯´æ˜ |
|------|--------|------|------|
| å­¦ç”Ÿ | 2021001 | 123456 | å¼ ä¸‰ï¼ˆè®¡ç®—æœºå­¦é™¢ï¼‰ |
| å­¦ç”Ÿ | 2021002 | 123456 | æå››ï¼ˆè®¡ç®—æœºå­¦é™¢ï¼‰ |
| æ•™å¸ˆ | T001 | 123456 | å¼ æ•™æˆ |
| æ•™åŠ¡ | A001 | 123456 | ç‹æ•™åŠ¡ |

## ğŸ”§ è¿è¡Œæµ‹è¯•

```powershell
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_auth.py -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=app --cov-report=html
```

## ğŸ“ ä¸»è¦ API ç«¯ç‚¹

### è®¤è¯
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/refresh` - åˆ·æ–°ä»¤ç‰Œ

### å­¦ç”Ÿ
- `GET /api/students/{id}/available-courses` - æŸ¥è¯¢å¯é€‰è¯¾ç¨‹
- `POST /api/students/{id}/enroll` - é€‰è¯¾
- `POST /api/students/{id}/drop` - é€€è¯¾
- `GET /api/students/{id}/schedule` - æŸ¥çœ‹è¯¾è¡¨

### æ•™å¸ˆ
- `GET /api/teachers/{id}/schedule` - æŸ¥çœ‹æˆè¯¾è¡¨
- `GET /api/teachers/{id}/students` - æŸ¥çœ‹å­¦ç”Ÿåå•

### ç»Ÿè®¡
- `GET /api/statistics/enrollment` - é€‰è¯¾ç»Ÿè®¡
- `GET /api/statistics/overview` - ç³»ç»Ÿæ¦‚è§ˆ

## âœ… æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼ˆæ¨èï¼‰

åœ¨å¯åŠ¨æœåŠ¡å‰ï¼Œå…ˆæµ‹è¯•æ•°æ®åº“è¿æ¥ï¼š

```powershell
python test_connection.py
```

å¦‚æœæ˜¾ç¤º "ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡"ï¼Œè¯´æ˜é…ç½®æ­£ç¡®ï¼

## âš ï¸ å¸¸è§é—®é¢˜

### Q: pip å®‰è£…ä¾èµ–æ—¶æç¤ºéœ€è¦ Rust ç¼–è¯‘å™¨ï¼Ÿ
A: è¿™æ˜¯å› ä¸º Python 3.13 ä½¿ç”¨äº†éœ€è¦ Rust çš„åŒ…ã€‚è§£å†³æ–¹æ¡ˆï¼š
- âœ… å·²åœ¨ `requirements.txt` ä¸­æŒ‡å®šå…¼å®¹ç‰ˆæœ¬ï¼ˆfastapi==0.115.0, pydantic==2.10.0ï¼‰
- å¦‚æœä»æœ‰é—®é¢˜ï¼Œé™çº§åˆ° Python 3.11 æˆ– 3.12

### Q: è¿æ¥æ•°æ®åº“å¤±è´¥ï¼Ÿ
A: æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®ï¼š
   ```env
   DB_HOST=your-taurusdb-endpoint.com  # åä¸ºäº‘ TaurusDB å¤–ç½‘åœ°å€
   DB_PORT=3306
   DB_USER=your_username
   DB_PASSWORD=your_password
   DB_NAME=course_selection_system
   ```
   è¿è¡Œ `python test_connection.py` æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

### Q: å¯¼å…¥é”™è¯¯ "No module named 'app'"ï¼Ÿ
A: ç¡®ä¿ï¼š
   1. è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»ï¼š`.\venv\Scripts\activate`
   2. åœ¨ `backend` ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤
   3. ä¾èµ–å·²å®‰è£…ï¼š`pip list | findstr fastapi`

### Q: ç«¯å£è¢«å ç”¨ï¼Ÿ
A: ä¿®æ”¹å¯åŠ¨å‘½ä»¤çš„ç«¯å£ï¼š`--port 8001`

### Q: WARNING: Scripts not on PATHï¼Ÿ
A: æ­£å¸¸è­¦å‘Šï¼Œä¸å½±å“ä½¿ç”¨ã€‚æˆ–è€…å°†ä»¥ä¸‹è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼š
   `C:\Users\<ä½ çš„ç”¨æˆ·å>\AppData\Roaming\Python\Python313\Scripts`

## ğŸ“š ä¸‹ä¸€æ­¥

- æŸ¥çœ‹ [README.md](README.md) äº†è§£å®Œæ•´åŠŸèƒ½
- é˜…è¯» [API æ–‡æ¡£](http://localhost:8000/docs)
- æŸ¥çœ‹ [è®¾è®¡æ–‡æ¡£](../docs/è®¾è®¡æ–‡æ¡£.md)

## ğŸ’¡ æç¤º

- å¼€å‘æ—¶ä½¿ç”¨ `--reload` å‚æ•°æ”¯æŒçƒ­é‡è½½
- ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…ä¿®æ”¹ `.env` ä¸­çš„ `SECRET_KEY`
- å»ºè®®å¯ç”¨ TaurusDB çš„ SSL/TLS è¿æ¥
- æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼š`logs/app.log`

ç¥å¼€å‘é¡ºåˆ©ï¼ğŸ‰
